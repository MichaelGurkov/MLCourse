---
title: "Homework3"
---

```{r include=FALSE}

knitr::opts_chunk$set(echo = FALSE, error = FALSE, warning = FALSE, message = FALSE)

```

```{r load_libraries}

library(tidyverse)

library(caret)


```

```{r load_data}

heart = read_csv(here::here("data","heart.csv"))

df = heart %>% 
  mutate(target = factor(target, levels = c(1,0)))

```

```{r split_train_test}

set.seed(167)

split_ind = createDataPartition(heart$target, list = FALSE)

train_set = heart[split_ind,]

test_set = heart[-split_ind,]


```

```{r set_formula}

formula_part = target ~ sex + cp + chol
formula_full = target ~ .

```

```{r fit_rpart_tree}

rpart_tree = rpart::rpart(formula = formula_part,
                          data = heart, method = "class")

rattle::fancyRpartPlot(rpart_tree, caption = NULL)


```

```{r restriction_comparison}

unres_model = rpart::rpart(formula = formula_full,
                          data = heart, method = "class")

res_model = rpart::rpart(formula = formula_full,
                          data = heart, method = "class",
                         minsplit = 2, minbucket = 1)



```


# Forests

```{r cv}

fitControl = trainControl(method = "repeatedcv",number = 5,repeats = 3)

```


```{r knn}

knn_model = train(
  x = select(train_set, -target),
  y = factor(train_set$target, levels = c("1","0")),
  method = "knn",
  trControl = fitControl
)

```


```{r bagging}

bag_model = train(
  x = select(train_set, -target),
  y = factor(train_set$target, levels = c("1","0")),
  method = "ada",
  trControl = fitControl
)

```


```{r boosting}

boost_model = train(
  x = select(train_set, -target),
  y = factor(train_set$target, levels = c("1","0")),
  method = "gbm",
  trControl = fitControl
)

```


```{r random_forest}

rf_model = train(
  x = select(train_set, -target),
  y = factor(train_set$target, levels = c("1","0")),
  method = "rf",
  trControl = fitControl
)

```

